# ADR-0018 — Threat Model e superfície de ataque do Sheer (CLI, Agent e Audit Server)

Status: Accepted  
Data: 2026-02-10

## Contexto
Ferramentas de auditoria são alvos naturais de abuso e precisam de um threat model explícito.

## Decisão
Adotar threat model conservador e documentado:
- deny by default
- execução restritiva por padrão (especialmente no agent)
- separação de responsabilidades (CLI/Agent/Server)
- sem execução de código analisado
- políticas imutáveis/assinadas quando distribuídas

## Ameaças consideradas
- shell/comandos arbitrários
- injeção de policy maliciosa
- exfiltração via relatórios/artefatos
- escrita fora do workspace
- abuso de IA como agente decisor

## Mitigações por design
- shell remoto proibido (ADR-0008)
- execução do código analisado proibida (ADR-0010)
- perfis explícitos (ADR-0002/0007)
- IR versionado e somente leitura (ADR-0015)
- IA somente consumidora (ADR-0016)

## Consequências
- Superfície de ataque mínima
- Aprovação facilitada por segurança
- Arquitetura defensável e auditável
